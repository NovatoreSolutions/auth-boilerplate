angular.module("MainCtrl",["ngMaterial","ngMessages"]).controller("MainController",["$scope","$rootScope","$location","$timeout","$mdSidenav","$log","$mdToast","Toast",function(e,o,t,r,n,a,l,s){function i(o,t,n){var a;return function(){var n=e,l=Array.prototype.slice.call(arguments);r.cancel(a),a=r(function(){a=void 0,o.apply(n,l)},t||10)}}function u(e){return i(function(){n(e).toggle().then(function(){})},200)}e.logOut=function(){o.user=null,localStorage.clear(),l.show(l.simple().textContent("Successfully logged out").position(s.getToastPosition()).hideDelay(3e3)),t.path("/")},e.toggleLeft=u("left")}]),angular.module("ToastService",[]).factory("Toast",[function(){function e(){var e=t;e.bottom&&o.top&&(e.top=!1),e.top&&o.bottom&&(e.bottom=!1),e.right&&o.left&&(e.left=!1),e.left&&o.right&&(e.right=!1),o=angular.extend({},e)}var o={bottom:!1,top:!0,left:!1,right:!0},t=angular.extend({},o);return{getToastPosition:function(){return e(),Object.keys(t).filter(function(e){return t[e]}).join(" ")}}}]),function(){angular.module("CustomFilter",[]).filter("capitalize",function(){return function(e,o){var t=o?/([^\W_]+[^\s-]*) */g:/([^\W_]+[^\s-]*)/;return e?e.replace(t,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}})}(),angular.module("appRoutes",[]).config(["$routeProvider","$locationProvider","$httpProvider",function(e,o,t){e.when("/",{templateUrl:"packages/authentication/login.html",controller:"AuthenticationController",resolve:{appRoutes:function(e,o){var t=o.defer(),r=localStorage.getItem("userToken"),n=localStorage.getItem("role");return r&&"Teacher"==n?e.path("/home-teacher"):r&&"Student"==n?e.path("/home-student"):t.resolve(),t.promise}}}).when("/sign-up",{templateUrl:"packages/authentication/sign-up.html",controller:"AuthenticationController",resolve:{appRoutes:function(e,o){var t=o.defer(),r=localStorage.getItem("userToken"),n=localStorage.getItem("role");return r&&"Teacher"==n?e.path("/home-teacher"):r&&"Student"==n?e.path("/home-student"):t.resolve(),t.promise}}}).when("/email-confirmation",{templateUrl:"packages/authentication/email-confirmation.html",controller:"EmailConfirmationController"}).when("/resend-email-confirmation/:email",{templateUrl:"packages/authentication/resend-email.html",controller:"AuthenticationController"}).when("/home-teacher",{templateUrl:"packages/home-screen/home-teacher.html",controller:"TeacherHomeController",resolve:{appRoutes:function(e,o){var t=o.defer(),r=localStorage.getItem("userToken"),n=localStorage.getItem("role");return r?r&&"Student"==n?e.path("/home-student"):t.resolve():e.path("/"),t.promise}}}).when("/home-student",{templateUrl:"packages/home-screen/home-student.html",controller:"StudentHomeController",resolve:{appRoutes:function(e,o){var t=o.defer(),r=localStorage.getItem("userToken"),n=localStorage.getItem("role");return r?r&&"Teacher"==n?e.path("/home-teacher"):t.resolve():e.path("/"),t.promise}}}).when("/social-user-boarding",{templateUrl:"packages/home-screen/social-user-boarding.html",controller:"SocialBoardingController"}).when("/after-login/:obj",{templateUrl:"packages/dashboard/facebookuser.html"}).otherwise({redirectTo:"/"}),o.html5Mode(!0),t.interceptors.push("authHttpResponseInterceptor")}]).factory("authHttpResponseInterceptor",["$q","$location",function(e,o){return{request:function(e){var o=localStorage.userToken;return e.headers.token=o,e},response:function(o){return 401===o.status&&console.log("Response 401"),o||e.when(o)},responseError:function(t){return console.log(t),401===t.status&&(console.log("Response Error 401",t),localStorage.clear(),o.path("/")),e.reject(t)}}}]),angular.module("AuthenticationCtrl",["ngMaterial"]).controller("AuthenticationController",["$scope","$rootScope","Authentication","$location","$mdToast","Toast","$routeParams",function(e,o,t,r,n,a,l){if(e.signUp=function(){console.log("signUP",e.user),e.signUpProgress=!0;var o=e.user;t.userSignup(o,function(o){e.signUpProgress=!1,n.show(n.simple().textContent(o.data.message).position(a.getToastPosition()).hideDelay(3e3)),r.path("/")},function(o){e.signUpProgress=!1,403==o.status?(e.emailError=o.data.message,console.log(e.emailError)):e.signUpError=o.data.message,console.log(o)})},e.hideError=function(){e.emailError=""},e.signIn=function(){e.loginProgress=!0,t.signin(e.user,function(e){o.user=e.data.data,localStorage.setItem("userToken",o.user.token),localStorage.setItem("role",o.user.role),n.show(n.simple().textContent("Logged into System").position(a.getToastPosition()).hideDelay(3e3)),"Teacher"==o.user.role?(console.log("Teacher"),r.path("/home-teacher")):(console.log("Student"),r.path("/home-student"))},function(o){401==o.status?r.path("/resend-email-confirmation/"+o.data.data):(e.loginError=o.data.message,e.loginProgress=!1,console.log(o))})},l.email){console.log(l.email);var s=l.email;e.resendConfirmationEmail=function(){e.resendProgress=!0,t.resendEmailConfirmation(s,function(o){e.resendProgress=!1,e.errorMessage=o.data.message,n.show(n.simple().textContent(o.data.message).position(a.getToastPosition()).hideDelay(3e3))},function(o){e.resendProgress=!1,e.errorMessage=o.data.message,console.log(o)})}}}]).directive("confirmPwd",["$interpolate","$parse",function(e,o){return{require:"ngModel",link:function(t,r,n,a){var l=o(n.confirmPwd),s=e(n.confirmPwd)(t);t.$watch(s,function(e){a.$setValidity("password",a.$viewValue==e)}),a.$validators.password=function(e,o){var r=e||o;return r==l(t)}}}}]),angular.module("AuthenticationService",[]).factory("Authentication",["$http",function(e){return{signin:function(o,t,r){e({method:"POST",url:"/api/sign-in",data:o}).then(function(e){t(e)},function(e){r(e)})},userSignup:function(o,t,r){e({method:"POST",url:"/api/sign-up",data:o}).then(function(e){t(e)},function(e){r(e)})},userEmailConfirmation:function(o,t,r){e({method:"GET",url:"/api/email-confirmation?token="+o}).then(function(e){t(e)},function(e){r(e)})},resendEmailConfirmation:function(o,t,r){e({method:"GET",url:"/api/resend-email-confirmation?email="+o}).then(function(e){t(e)},function(e){r(e)})}}}]),angular.module("EmailConfirmationCtrl",["ngMaterial"]).controller("EmailConfirmationController",["$scope","$rootScope","Authentication","$location","$mdToast","Toast",function(e,o,t,r,n,a){function l(){t.userEmailConfirmation(s,function(e){o.user=e.data.data,localStorage.setItem("userToken",o.user.token),localStorage.setItem("role",o.user.role),n.show(n.simple().textContent("Email Successfully Confirmed").position(a.getToastPosition()).hideDelay(3e3)),"Teacher"==o.user.role?(console.log("Teacher"),r.url(r.path("/home-teacher"))):(console.log("Student"),r.url(r.path("/home-student")))},function(e){r.url(r.path("/")),console.log(e)})}var s=r.search().token;s?l():r.url(r.path("/"))}]),angular.module("DashboardCtrl",["ngMaterial","ngMessages"]).controller("DashboardController",["$scope","$location","$timeout","Dashboard","$mdSidenav","$log",function(e,o,t,r,n,a){}]).controller("LeftCtrl",["$scope","$rootScope","$location","$timeout","$mdSidenav","$log",function(e,o,t,r,n,a){e.close=function(){n("left").close().then(function(){a.debug("close LEFT is done")})},e.logOutUser=function(){o.admin=null,localStorage.clear(),t.path("/admin")}}]),angular.module("DashboardService",[]).factory("Dashboard",["$http",function(e){return{}}]),angular.module("HomeService",[]).factory("HomeService",["$http",function(e){return{setUserRole:function(o,t,r,n){console.log("in Service");var a="/api/user/"+o+"/updateRole";e({method:"POST",url:a,data:t}).then(function(e){r(e)},function(e){n(e)})},updateUserInfo:function(o,t,r){e({method:"POST",url:"/api/sign-up",data:o}).then(function(e){t(e)},function(e){r(e)})}}}]),angular.module("SocialBoardingCtrl",["ngMaterial","ngMessages"]).controller("SocialBoardingController",["$scope","$rootScope","$location","$timeout","$mdSidenav","$log","$routeParams","HomeService","$mdToast","Toast",function(e,o,t,r,n,a,l,s,i,u){e.sideNavSpanHome="side-nav-span-bold",e.controllerName="",e.user={},e.topProgessBar=!0;var c=t.search();if(o.user=c,console.log("query string",o.user),o.user.email&&(e.user.email=o.user.email,e.disableEmail=!0),e.hideErrorMsg=function(){e.errorMessage=""},o.user.userId&&o.user.token)if(i.show(i.simple().textContent("Logged into System").position(u.getToastPosition()).hideDelay(3e3)),localStorage.setItem("userToken",o.user.token),o.user.role&&o.user.email)"Teacher"==o.user.role?(localStorage.setItem("role",o.user.role),t.url(t.path("/home-teacher"))):(localStorage.setItem("role",o.user.role),t.url(t.path("/home-student")));else{e.topProgessBar=!1,e.showBoardingForm=!0;var m=o.user.userId;e.teacherBtn=function(){e.user.email?(e.roleButton=!0,e.progressBar=!0,console.log(e.user.email),e.user.role="Teacher",s.setUserRole(m,e.user,function(e){o.user=e.data.data,localStorage.setItem("role",o.user.role),t.url(t.path("/home-teacher"))},function(o){e.roleButton=!1,console.log(o),e.progressBar=!1,404==o.status?(e.errorMessage=o.data.data,t.path("/")):e.errorMessage=o.data.data})):e.errorMessage="Provide your Email Address."},e.studentBtn=function(){e.user.email?(e.roleButton=!0,e.progressBar=!0,console.log(e.user.email),e.user.role="Student",s.setUserRole(m,e.user,function(e){o.user=e.data.data,localStorage.setItem("role",o.user.role),t.url(t.path("/home-student"))},function(o){e.roleButton=!0,console.log(o),e.progressBar=!1,404==o.status?(e.errorMessage=o.data.data,t.url(t.path("/"))):e.errorMessage=o.data.data})):e.errorMessage="Provide your Email Address."}}else t.url(t.path("/"))}]),angular.module("StudentHomeCtrl",["ngMaterial","ngMessages"]).controller("StudentHomeController",["$scope","$location","$timeout","$mdSidenav","$log","$mdToast","Toast",function(e,o,t,r,n,a,l){e.sideNavSpanHome="side-nav-span-bold",e.controllerName="Home",t(function(){a.show(a.simple().textContent("Welcome to Student's Dashboard").position(l.getToastPosition()).hideDelay(3e3))},2e3)}]),angular.module("TeacherHomeCtrl",["ngMaterial","ngMessages"]).controller("TeacherHomeController",["$scope","$location","$timeout","$mdSidenav","$log","$mdToast","Toast",function(e,o,t,r,n,a,l){e.sideNavSpanHome="side-nav-span-bold",e.controllerName="Home",t(function(){a.show(a.simple().textContent("Welcome to Teacher's Dashboard").position(l.getToastPosition()).hideDelay(3e3))},2e3)}]);